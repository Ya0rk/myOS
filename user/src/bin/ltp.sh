#!/bin/sh

echo "#### OS COMP TEST GROUP START ltp-musl ####"

# Define target directory
target_dir="/musl/ltp/testcases/bin"

backip=$(cat <<EOF
chown02
abs01
accept01
accept03
alarm02
alarm03
alarm05
alarm06
alarm07
bind01
brk01
capget01
chmod01
chmod03
chmod05
chown01
chown02
chown03
chown05
chroot02
clock_getres01
clock_gettime02
clock_nanosleep04
clone01
clone03
clone06
clone07
clone08
close_range02
close01
creat01
dup01
dup02
dup03
dup3_01
dup3_02
dup04
dup07
dup202
dup203
dup204
dup204
dup207
exit01
exit02
faccessat01
faccessat01
faccessat201
fchown01
fchown02
fchown01
fchown05
fcntl01
fcntl01_64
fcntl02
fcntl02_64
fcntl03
fcntl03_64
fcntl04
fcntl04_64
fcntl05
fcntl05_64
fcntl07
fcntl07_64
fcntl08
fcntl08_64
fcntl09
fcntl09_64
fcntl10
fcntl10_64
fcntl13
fcntl13_64
fcntl25
fcntl25_64
fcntl26
fcntl26_64
fcntl27
fcntl27_64
fcntl29
fcntl29_64
fcntl30
fcntl30_64
fcntl31
fcntl31_64
fcntl32
fcntl32_64
fcntl33
fcntl33_64
fcntl34
fcntl34_64
fork01
fork03
fork04
fork05
fork07
fork08
fork10
fork13
llseek01
llseek02
llseek03
lseek01
lseek02
lseek07
lseek11
fstat02
fstat02_64
fstat03
fstat03_64
fstatat01
fstatfs01
lstat02
lstat02_64
stat01
stat01_64
stat02
stat02_64
statx01
statx02
stream01
stream02
stream03
stream04
stream05
getcwd01
getcwd02
getcwd03
getcwd04
mq_open01
nfs01_open_files
open01
open02
open03
open06
open07
open09
open10
open11
open12
open12_child
open13
open14
open_by_handle_at01
open_by_handle_at02
openat01
openat02
openat02_child
openat03
openat04
openat202
openat203
pidfd_open01
pidfd_open02
pidfd_open03
pidfd_open04
dma_thread_diotest
pread01
pread01_64
pread02
pread02_64
preadv01
preadv01_64
preadv02
preadv02_64
preadv201
preadv201_64
preadv202
preadv202_64
preadv203
preadv203_64
process_vm_readv02
process_vm_readv03
read01
read02
read03
read04
read_all
readahead01
readahead02
readdir01
readdir21
readv01
EOF
)

# List of test cases (no array, using space-separated string)
ltp_cases=$(cat <<EOF
chown02
abs01
accept01
accept03
alarm02
alarm03
alarm05
alarm06
alarm07
bind01
brk01
capget01
chmod01
chmod03
chmod05
chown01
chown02
chown03
chown05
chroot02
clock_getres01
clock_gettime02
clock_nanosleep04
clone01
clone03
clone06
clone07
clone08
close_range02
close01
creat01
dup01
dup02
dup03
dup3_01
dup3_02
dup04
dup07
dup202
dup203
dup204
dup204
dup207
exit01
exit02
faccessat01
faccessat01
faccessat201
fchown01
fchown02
fchown01
fchown05
fcntl01
fcntl01_64
fcntl02
fcntl02_64
fcntl03
fcntl03_64
fcntl04
fcntl04_64
fcntl05
fcntl05_64
fcntl07
fcntl07_64
fcntl08
fcntl08_64
fcntl09
fcntl09_64
fcntl10
fcntl10_64
fcntl13
fcntl13_64
fcntl25
fcntl25_64
fcntl26
fcntl26_64
fcntl27
fcntl27_64
fcntl29
fcntl29_64
fcntl30
fcntl30_64
fcntl31
fcntl31_64
fcntl32
fcntl32_64
fcntl33
fcntl33_64
fcntl34
fcntl34_64
fork01
fork03
fork04
fork05
fork07
fork08
fork10
fork13
llseek01
llseek02
llseek03
lseek01
lseek02
lseek07
lseek11
fstat02
fstat02_64
fstat03
fstat03_64
fstatat01
lstat02
lstat02_64
stat01
stat01_64
stat02
stat02_64
statx01
statx02
stream01
stream02
stream03
stream04
stream05
getcwd01
getcwd02
getcwd03
getcwd04
mq_open01
nfs01_open_files
open01
open02
open03
open06
open07
open09
open10
open11
open12
open12_child
open13
open14
open_by_handle_at01
open_by_handle_at02
openat01
openat02
openat02_child
openat03
openat04
openat202
openat203
pidfd_open01
pidfd_open02
pidfd_open03
pidfd_open04
dma_thread_diotest
pread01
pread01_64
pread02
pread02_64
preadv01
preadv01_64
preadv02
preadv02_64
preadv201
preadv201_64
preadv202
preadv202_64
preadv203
preadv203_64
process_vm_readv02
process_vm_readv03
read01
read02
read03
read04
read_all
readahead01
readahead02
readdir01
readdir21
readv01
EOF
)

for case in $ltp_cases; do
  file="$target_dir/$case"

  if [ -f "$file" ]; then
    echo "RUN LTP CASE $case"

    "$file"
    ret=$?

    echo "FAIL LTP CASE $case : $ret"
    #   else
    #     echo "SKIP LTP CASE $case : not found"
  fi
done

echo "#### OS COMP TEST GROUP END ltp-musl ####"